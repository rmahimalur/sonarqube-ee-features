package foo.security.injection;

import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerabilityCollectionMultipleFiles {

  public SQLInjectionVulnerabilityCollectionMultipleFiles(String sql) throws SQLException {
    Connection con = DatabaseHelper.getJDBCConnection();
    Statement stmt = null;

    try {
      stmt = con.createStatement();

      if (sql == null) {
        sql = "default";
      }

      stmt.execute(sql); // Noncompliant

      stmt.execute("select FNAME, LNAME, SSN from USERS where UNAME = default"); // Compliant: hard-coded SQL statement

    } catch (Exception e) {
      // ...
    } finally {
      if (stmt != null) {
        stmt.close();
      }
    }
  }
}
