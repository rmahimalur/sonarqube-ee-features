package foo.security.injection;

import java.io.IOException;
import java.sql.SQLException;

public class CommandInjectionVulnerability {

  public CommandInjectionVulnerability(String path) throws SQLException, IOException {
    Runtime runtime = Runtime.getRuntime();

    String[] command = "rm -rf /tmp/bla".split(" ");

    if (path != null) {
      command[command.length - 1] = path;
    }

    runtime.exec(command); // Noncompliant

    runtime.exec("rm -rf /tmp/bla"); // No Injection possible but still security-sensitive.
  }
}
